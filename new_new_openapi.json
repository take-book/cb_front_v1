{"openapi":"3.1.0","info":{"title":"Chat LLM Service API","version":"0.1.0"},"paths":{"/api/v1/auth/login":{"post":{"tags":["auth"],"summary":"Login","operationId":"login_api_v1_auth_login_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_api_v1_auth_login_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/refresh":{"post":{"tags":["auth"],"summary":"Refresh Token","description":"トークンをリフレッシュする","operationId":"refresh_token_api_v1_auth_refresh_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/auth/me":{"get":{"tags":["auth"],"summary":"Get Current User Info","operationId":"get_current_user_info_api_v1_auth_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/chats/":{"post":{"tags":["chats"],"summary":"Create Chat","description":"新しいチャットを開始し、チャットUUIDを返す","operationId":"create_chat_api_v1_chats__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatCreateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatCreateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["chats"],"summary":"Get Chats With Search And Pagination","description":"チャットの一覧をページネーション・ソート・キーワード検索付きで取得する","operationId":"get_chats_with_search_and_pagination_api_v1_chats__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Limit"}},{"name":"sort","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"updated_at.desc","title":"Sort"}},{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Q"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/{chat_uuid}/messages":{"post":{"tags":["chats"],"summary":"Send Message","description":"既存チャットにメッセージを送信し、アシスタントの応答を返す\nparent_message_uuidが指定されている場合、その親から分岐させる","operationId":"send_message_api_v1_chats__chat_uuid__messages_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["chats"],"summary":"Get History","description":"指定チャットの全メッセージ履歴を返却","operationId":"get_history_api_v1_chats__chat_uuid__messages_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HistoryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/{chat_uuid}/messages/{message_id}/retry":{"post":{"tags":["chats"],"summary":"Retry Message","description":"失敗したメッセージを再試行する","operationId":"retry_message_api_v1_chats__chat_uuid__messages__message_id__retry_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}},{"name":"message_id","in":"path","required":true,"schema":{"type":"string","title":"Message Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/recent":{"get":{"tags":["chats"],"summary":"Get Recent Chats","description":"最近のチャット一覧を取得する（ページネーション対応）","operationId":"get_recent_chats_api_v1_chats_recent_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/{chat_uuid}":{"delete":{"tags":["chats"],"summary":"Delete Chat","description":"チャットを削除する","operationId":"delete_chat_api_v1_chats__chat_uuid__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["chats"],"summary":"Get Chat Metadata","description":"チャットのメタデータを取得する","operationId":"get_chat_metadata_api_v1_chats__chat_uuid__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatMetadataResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["chats"],"summary":"Update Chat","description":"チャットのタイトルやシステムプロンプトを更新する","operationId":"update_chat_api_v1_chats__chat_uuid__patch","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateChatRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/{chat_uuid}/search":{"get":{"tags":["chats"],"summary":"Search Messages","description":"チャット内のメッセージを検索する","operationId":"search_messages_api_v1_chats__chat_uuid__search_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}},{"name":"q","in":"query","required":true,"schema":{"type":"string","title":"Q"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/{chat_uuid}/messages/{message_id}":{"patch":{"tags":["chats"],"summary":"Edit Message","description":"既存メッセージの内容を修正する","operationId":"edit_message_api_v1_chats__chat_uuid__messages__message_id__patch","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}},{"name":"message_id","in":"path","required":true,"schema":{"type":"string","title":"Message Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EditMessageRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["chats"],"summary":"Delete Message","description":"指定されたメッセージをチャット履歴から削除する","operationId":"delete_message_api_v1_chats__chat_uuid__messages__message_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}},{"name":"message_id","in":"path","required":true,"schema":{"type":"string","title":"Message Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/{chat_uuid}/complete":{"get":{"tags":["chats"],"summary":"Get Complete Chat Data","description":"チャットの全データを一括取得する（フロントエンド状態管理用）\nメッセージ履歴、ツリー構造、メタデータを一度に返す","operationId":"get_complete_chat_data_api_v1_chats__chat_uuid__complete_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompleteChatDataResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chats/{chat_uuid}/tree":{"get":{"tags":["chats"],"summary":"Get Tree Structure","description":"チャットのツリー構造のみを取得する（レガシーサポート）","operationId":"get_tree_structure_api_v1_chats__chat_uuid__tree_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"chat_uuid","in":"path","required":true,"schema":{"type":"string","title":"Chat Uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TreeStructureResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/users":{"post":{"tags":["users"],"summary":"Register User","description":"新規ユーザー登録","operationId":"register_user_api_v1_users_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegisterRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegisterResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/models/":{"get":{"tags":["models"],"summary":"Get Available Models","description":"利用可能なモデル一覧を取得する\n\nArgs:\n    category: モデルのカテゴリでフィルタリング（オプション）\n    \nReturns:\n    利用可能なモデルのリスト","operationId":"get_available_models_api_v1_models__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"category","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelListResponseDto"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/models/select":{"post":{"tags":["models"],"summary":"Select Model","description":"使用するモデルを選択・設定する\n\nArgs:\n    req: モデル選択リクエスト\n    \nReturns:\n    選択結果のメッセージ","operationId":"select_model_api_v1_models_select_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelSelectionRequestDto"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/models/current":{"get":{"tags":["models"],"summary":"Get Current Model","description":"現在選択されているモデルを取得する\n\nReturns:\n    現在のモデル情報","operationId":"get_current_model_api_v1_models_current_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/health":{"get":{"summary":"Health Check","description":"ヘルスチェックエンドポイント","operationId":"health_check_api_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Body_login_api_v1_auth_login_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_api_v1_auth_login_post"},"ChatCreateRequest":{"properties":{"initial_message":{"anyOf":[{"type":"string","maxLength":4000},{"type":"null"}],"title":"Initial Message"},"model_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model Id"}},"type":"object","title":"ChatCreateRequest"},"ChatCreateResponse":{"properties":{"chat_uuid":{"type":"string","pattern":"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$","title":"Chat Uuid"}},"type":"object","required":["chat_uuid"],"title":"ChatCreateResponse"},"ChatMetadataResponse":{"properties":{"chat_uuid":{"type":"string","title":"Chat Uuid"},"title":{"type":"string","title":"Title"},"created_at":{"type":"string","title":"Created At"},"updated_at":{"type":"string","title":"Updated At"},"message_count":{"type":"integer","title":"Message Count"},"owner_id":{"type":"string","title":"Owner Id"}},"type":"object","required":["chat_uuid","title","created_at","updated_at","message_count","owner_id"],"title":"ChatMetadataResponse"},"CompleteChatDataResponse":{"properties":{"chat_uuid":{"type":"string","title":"Chat Uuid"},"title":{"type":"string","title":"Title"},"system_prompt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"System Prompt"},"messages":{"items":{"$ref":"#/components/schemas/HistoryMessage"},"type":"array","title":"Messages"},"tree_structure":{"$ref":"#/components/schemas/TreeNode"},"metadata":{"additionalProperties":true,"type":"object","title":"Metadata"}},"type":"object","required":["chat_uuid","title","system_prompt","messages","tree_structure","metadata"],"title":"CompleteChatDataResponse"},"EditMessageRequest":{"properties":{"content":{"type":"string","maxLength":4000,"minLength":1,"title":"Content"}},"type":"object","required":["content"],"title":"EditMessageRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HistoryMessage":{"properties":{"message_uuid":{"type":"string","title":"Message Uuid"},"role":{"type":"string","title":"Role"},"content":{"type":"string","title":"Content"}},"type":"object","required":["message_uuid","role","content"],"title":"HistoryMessage"},"HistoryResponse":{"properties":{"messages":{"items":{"$ref":"#/components/schemas/HistoryMessage"},"type":"array","title":"Messages"}},"type":"object","required":["messages"],"title":"HistoryResponse"},"MessageRequest":{"properties":{"content":{"type":"string","maxLength":4000,"minLength":1,"title":"Content"},"parent_message_uuid":{"anyOf":[{"type":"string","pattern":"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"},{"type":"null"}],"title":"Parent Message Uuid"},"model_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model Id"}},"type":"object","required":["content"],"title":"MessageRequest"},"MessageResponse":{"properties":{"message_uuid":{"type":"string","title":"Message Uuid"},"content":{"type":"string","title":"Content"},"parent_message_uuid":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Parent Message Uuid"},"current_path":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Current Path"}},"type":"object","required":["message_uuid","content"],"title":"MessageResponse"},"ModelArchitectureDto":{"properties":{"input_modalities":{"items":{"type":"string"},"type":"array","title":"Input Modalities"},"output_modalities":{"items":{"type":"string"},"type":"array","title":"Output Modalities"},"tokenizer":{"type":"string","title":"Tokenizer"}},"type":"object","required":["input_modalities","output_modalities","tokenizer"],"title":"ModelArchitectureDto"},"ModelDto":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"created":{"type":"integer","title":"Created"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"architecture":{"anyOf":[{"$ref":"#/components/schemas/ModelArchitectureDto"},{"type":"null"}]},"pricing":{"anyOf":[{"$ref":"#/components/schemas/ModelPricingDto"},{"type":"null"}]},"context_length":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Context Length"}},"type":"object","required":["id","name","created"],"title":"ModelDto"},"ModelListResponseDto":{"properties":{"data":{"items":{"$ref":"#/components/schemas/ModelDto"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"ModelListResponseDto"},"ModelPricingDto":{"properties":{"prompt":{"type":"string","title":"Prompt"},"completion":{"type":"string","title":"Completion"}},"type":"object","required":["prompt","completion"],"title":"ModelPricingDto"},"ModelSelectionRequestDto":{"properties":{"model_id":{"type":"string","title":"Model Id"}},"type":"object","required":["model_id"],"title":"ModelSelectionRequestDto"},"PaginatedResponse":{"properties":{"items":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"},"page":{"type":"integer","title":"Page"},"limit":{"type":"integer","title":"Limit"},"pages":{"type":"integer","title":"Pages"}},"type":"object","required":["items","total","page","limit","pages"],"title":"PaginatedResponse"},"TreeNode":{"properties":{"uuid":{"type":"string","title":"Uuid"},"role":{"type":"string","title":"Role"},"content":{"type":"string","title":"Content"},"children":{"items":{"$ref":"#/components/schemas/TreeNode"},"type":"array","title":"Children"}},"type":"object","required":["uuid","role","content","children"],"title":"TreeNode"},"TreeStructureResponse":{"properties":{"chat_uuid":{"type":"string","title":"Chat Uuid"},"tree":{"$ref":"#/components/schemas/TreeNode"}},"type":"object","required":["chat_uuid","tree"],"title":"TreeStructureResponse"},"UpdateChatRequest":{"properties":{"title":{"anyOf":[{"type":"string","maxLength":200,"minLength":1},{"type":"null"}],"title":"Title"},"system_prompt":{"anyOf":[{"type":"string","maxLength":2000},{"type":"null"}],"title":"System Prompt"}},"type":"object","title":"UpdateChatRequest"},"UserRegisterRequest":{"properties":{"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"}},"type":"object","required":["username","password"],"title":"UserRegisterRequest"},"UserRegisterResponse":{"properties":{"uuid":{"type":"string","title":"Uuid"},"username":{"type":"string","title":"Username"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["uuid","username","created_at"],"title":"UserRegisterResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/api/v1/auth/login"}}}}}}